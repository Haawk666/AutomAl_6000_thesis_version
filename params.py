# Program imports:
import core
import utils
# External imports:
import numpy as np
from matplotlib import pyplot as plt
from matplotlib.gridspec import GridSpec
import logging
# Instantiate logger
logger = logging.getLogger(__name__)
logger.setLevel(logging.DEBUG)


class Model:

    def __init__(self, default=True):

        self.mean_matrix = []
        self.var_matrix = []

        self.covar_matrices = []
        self.inverse_covar_matrices = []
        self.covar_matrix_determinants = []

        self.reduced_model_covar_matrices = []
        self.reduced_model_inverse_covar_matrices = []
        self.reduced_model_covar_matrix_determinants = []

        if default:
            self.set_default()


    def set_default(self):

        params = [
            [(1.94, 0.15), (2.25, 0.20), (1.94, 0.16), (2.19, 0.13), (2.07, 0.2), (0.52, 0.22), (0.48, 0.14)],
            [(1.94, 0.10), (2.26, 0.11), (1.93, 0.12), (2.26, 0.11), (2.09, 0.2), (0.32, 0.07), (0.32, 0.05)],
            [(1.60, 0.13), (2.45, 0.15), (1.61, 0.14), (2.43, 0.13), (2.09, 0.2), (0.33, 0.06), (0.32, 0.04)],
            [(1.46, 0.13), (3.13, 0.21), (1.37, 0.13), (1.76, 0.14), (1.57, 0.2), (0.29, 0.13), (0.31, 0.08)],
            [(1.54, 0.13), (3.11, 0.08), (1.48, 0.06), (1.66, 0.06), (1.57, 0.2), (0.30, 0.04), (0.31, 0.03)],
            [(1.25, 0.11), (2.63, 0.11), (1.13, 0.06), (1.42, 0.10), (1.26, 0.2), (0.19, 0.09), (0.24, 0.05)],
            [(1.23, 0.07), (3.72, 0.13), (1.10, 0.07), (1.43, 0.11), (1.26, 0.2), (0.14, 0.12), (0.22, 0.06)]
        ]

        covar_matrices = [
            [
                [0.022648650334570496, -0.027645127220884753, 0.0200335378079343, 0.0015594624121189756,
                 0.010067445926132058, 0.002743395757837704, -0.00019517536806345955],
                [-0.027645127220884753, 0.04084579216897273, -0.025718336788345356, -0.008592483127991712,
                 -0.01782442417822993, -0.004654797440117838, -0.0014262888836593],
                [0.0200335378079343, -0.025718336788345356, 0.024675395084470617, 0.006387820585320769,
                 0.015340247873176128, 0.0035503578978846317, 0.0010410982595269362],
                [0.0015594624121189756, -0.008592483127991712, 0.006387820585320769, 0.018267707676014548,
                 0.012518925933027796, 0.005067650443490714, 0.004866515075976046],
                [0.010067445926132058, -0.01782442417822993, 0.015340247873176128, 0.012518925933027796,
                 0.014667205479115063, 0.004693934424054179, 0.0033841992369680013],
                [0.002743395757837704, -0.004654797440117838, 0.0035503578978846317, 0.005067650443490714,
                 0.004693934424054179, 0.04777305454209432, 0.02683372194610089],
                [-0.00019517536806345955, -0.0014262888836593, 0.0010410982595269362, 0.004866515075976046,
                 0.0033841992369680013, 0.02683372194610089, 0.018412469396056032]
            ], [
                [0.010306188761245687, -0.008651122978231673, 0.010813932963714341, -0.007848180405247538,
                 0.0009313052983587536, 0.00017446462922569904, -0.00045543844108437124],
                [-0.008651122978231673, 0.011728705974255975, -0.00890900782817443, 0.010470808169094608,
                 -0.0007228499968940312, -0.000651922187728199, 7.0917358039492e-05],
                [0.010813932963714341, -0.00890900782817443, 0.013358621895039889, -0.007763852086722958,
                 0.0020956910615236614, 0.00019694930115491424, -0.000498399256254598],
                [-0.007848180405247538, 0.010470808169094608, -0.007763852086722958, 0.011572889977097474,
                 0.0003853039767524065, -0.0007707952268365705, -9.421345693527678e-07],
                [0.0009313052983587536, -0.0007228499968940312, 0.0020956910615236614, 0.0003853039767524065,
                 0.0013227038097855472, 8.693422520112577e-06, -3.036401818677686e-05],
                [0.00017446462922569904, -0.000651922187728199, 0.00019694930115491424, -0.0007707952268365705,
                 8.693422520112577e-06, 0.005210963912387357, 0.002931902523192387],
                [-0.00045543844108437124, 7.0917358039492e-05, -0.000498399256254598, -9.421345693527678e-07,
                 -3.036401818677686e-05, 0.002931902523192387, 0.002116691221292608]
            ], [
                [0.01678520002721852, -0.013126903237079976, 0.012330325385693987, -0.0069407777446220675,
                 -9.135390777773974e-05, -0.0008529987669254292, -0.0003002618319876916],
                [-0.013126903237079976, 0.022305926985780374, -0.0015982911289726327, 0.00786005255845592,
                 0.0016194483285311674, 0.0004166108774680984, -0.0006483711749512275],
                [0.012330325385693987, -0.0015982911289726327, 0.020119339288631546, -0.006418821870712919,
                 0.0038090493936126105, 0.00021622155702654083, 0.00012233040558602375],
                [-0.0069407777446220675, 0.00786005255845592, -0.006418821870712919, 0.017813752913677226,
                 0.0060248234913863235, -0.0008380345881734296, -0.002032342324832327],
                [-9.135390777773974e-05, 0.0016194483285311674, 0.0038090493936126105, 0.0060248234913863235,
                 0.00575565313840183, 5.341455621648217e-05, -0.000489042307538778],
                [-0.0008529987669254292, 0.0004166108774680984, 0.00021622155702654083, -0.0008380345881734296,
                 5.341455621648217e-05, 0.003748167800896899, 0.0023465972932717213],
                [-0.0003002618319876916, -0.0006483711749512275, 0.00012233040558602375, -0.002032342324832327,
                 -0.000489042307538778, 0.0023465972932717213, 0.001968965997741974]
            ], [
                [0.016107288005557895, -0.016942901504210104, 0.003900525263828343, -0.004671836736636052,
                 0.0009035869814774918, -0.0002097482502627844, -0.00010264358905760681],
                [-0.016942901504210104, 0.045979483249919066, -0.002150487248570599, -0.003969618826281033,
                 -0.0030779526551379167, 0.002052812069807938, 0.001091693401271756],
                [0.003900525263828343, -0.002150487248570599, 0.017249847868575446, -0.002998097679297074,
                 0.005478703159528016, 0.0006501853587999445, -3.884902747965966e-05],
                [-0.004671836736636052, -0.003969618826281033, -0.002998097679297074, 0.01872915760600197,
                 0.005121612760494978, 0.00013387871495120805, -0.00019163512774617877],
                [0.0009035869814774918, -0.0030779526551379167, 0.005478703159528016, 0.005121612760494978,
                 0.004952614988938859, 0.0010925124119038228, 0.00039226111803334604],
                [-0.0002097482502627844, 0.002052812069807938, 0.0006501853587999445, 0.00013387871495120805,
                 0.0010925124119038228, 0.016845560433143125, 0.010225807306905454],
                [-0.00010264358905760681, 0.001091693401271756, -3.884902747965966e-05, -0.00019163512774617877,
                 0.00039226111803334604, 0.010225807306905454, 0.007077800371372914]
            ], [
                [0.003422635196015581, -0.0032209052856532767, 0.0008494249590744646, -0.0012381745637875534,
                 -1.007821796696856e-05, -1.39815301941015e-05, -9.99260970413752e-06],
                [-0.0032209052856532767, 0.006839391401543439, 0.0009396564958604061, -0.0009312677335227616,
                 2.4116892068159658e-05, 2.3311159776708222e-05, -5.616191239811191e-05],
                [0.0008494249590744646, 0.0009396564958604061, 0.003054312462054447, -0.0024618051941323995,
                 2.3058858092434184e-05, -2.3194523380736623e-05, -0.00011752998474178386],
                [-0.0012381745637875534, -0.0009312677335227616, -0.0024618051941323995, 0.0032219558695637178,
                 4.25205374520004e-06, 1.0896020914063238e-06, 9.459258956991304e-05],
                [-1.007821796696856e-05, 2.4116892068159658e-05, 2.3058858092434184e-05, 4.25205374520004e-06,
                 1.0864280100894832e-05, -5.26276548620809e-07, -8.828929457977267e-07],
                [-1.39815301941015e-05, 2.3311159776708222e-05, -2.3194523380736623e-05, 1.0896020914063238e-06,
                 -5.26276548620809e-07, 0.0018716601385022444, 0.001022135426731448],
                [-9.99260970413752e-06, -5.616191239811191e-05, -0.00011752998474178386, 9.459258956991304e-05,
                 -8.828929457977267e-07, 0.001022135426731448, 0.0007150990959241952]
            ], [
                [0.01145965687215369, -0.008777986288223578, 0.0009721238940983024, -0.0031221902953149925,
                 -0.00028407712108580586, -0.0012724031135282789, -0.0006326119956056747],
                [-0.008777986288223578, 0.013041426332937813, -0.0029865756606928667, 0.006331900557094506,
                 9.559035497315502e-06, 0.0024406834587570444, 0.0014287594355276935],
                [0.0009721238940983024, -0.0029865756606928667, 0.0034152598915310737, -0.002581106921966777,
                 0.0004522639757064418, -0.000852076337650784, -0.0005857498290054954],
                [-0.0031221902953149925, 0.006331900557094506, -0.002581106921966777, 0.009810980383044477,
                 0.0008736151709440963, 0.0010860803978182847, 0.0006697391255171004],
                [-0.00028407712108580586, 9.559035497315502e-06, 0.0004522639757064418, 0.0008736151709440963,
                 0.0006001212516048076, -0.00010125739990906646, -8.303407301620206e-05],
                [-0.0012724031135282789, 0.0024406834587570444, -0.000852076337650784, 0.0010860803978182847,
                 -0.00010125739990906646, 0.007407002973675, 0.003900955856224677],
                [-0.0006326119956056747, 0.0014287594355276935, -0.0005857498290054954, 0.0006697391255171004,
                 -8.303407301620206e-05, 0.003900955856224677, 0.0022591791781077122]
            ], [
                [0.005535015521031184, -0.00821906793857138, -0.00020570427832911688, -0.002668752048211221,
                 -6.864778906597793e-05, -0.0014307392572495941, -0.001077024542994729],
                [-0.00821906793857138, 0.018179761764009334, 0.0022778230282678035, 0.004315155577228411,
                 0.0007631060207498307, -0.00021975210207021416, 0.0005096433146465212],
                [-0.00020570427832911688, 0.0022778230282678035, 0.005271896590861272, 0.0006736682269920776,
                 0.0027806802682252174, -0.002565395181735502, -0.001329325177933554],
                [-0.002668752048211221, 0.004315155577228411, 0.0006736682269920776, 0.011555565293658254,
                 0.0038222591339815847, 0.0027493022344800863, 0.0015450451479367493],
                [-6.864778906597793e-05, 0.0007631060207498307, 0.0027806802682252174, 0.0038222591339815847,
                 0.0032841073930092598, -0.0008820550248675384, -0.00044690343108490146],
                [-0.0014307392572495941, -0.00021975210207021416, -0.002565395181735502, 0.0027493022344800863,
                 -0.0008820550248675384, 0.01479812250533739, 0.00672475164135033],
                [-0.001077024542994729, 0.0005096433146465212, -0.001329325177933554, 0.0015450451479367493,
                 -0.00044690343108490146, 0.00672475164135033, 0.0035160180042092936]
            ]
        ]

        reduced_model_covar_matrices = [
            [
                [0.022648650334570496, -0.027645127220884753, 0.002743395757837704, -0.00019517536806345955],
                [-0.027645127220884753, 0.04084579216897273, -0.004654797440117838, -0.0014262888836593],
                [0.002743395757837704, -0.004654797440117838, 0.04777305454209432, 0.02683372194610089],
                [-0.00019517536806345955, -0.0014262888836593, 0.02683372194610089, 0.018412469396056032]
            ], [
                [0.010306188761245687, -0.008651122978231673, 0.00017446462922569904, -0.00045543844108437124],
                [-0.008651122978231673, 0.011728705974255975, -0.000651922187728199, 7.0917358039492e-05],
                [0.00017446462922569904, -0.000651922187728199, 0.005210963912387357, 0.002931902523192387],
                [-0.00045543844108437124, 7.0917358039492e-05, 0.002931902523192387, 0.002116691221292608]
            ], [
                [0.01678520002721852, -0.013126903237079976, -0.0008529987669254292, -0.0003002618319876916],
                [-0.013126903237079976, 0.022305926985780374, 0.0004166108774680984, -0.0006483711749512275],
                [-0.0008529987669254292, 0.0004166108774680984, 0.003748167800896899, 0.0023465972932717213],
                [-0.0003002618319876916, -0.0006483711749512275, 0.0023465972932717213, 0.001968965997741974]
            ], [
                [0.016107288005557895, -0.016942901504210104, -0.0002097482502627844, -0.00010264358905760681],
                [-0.016942901504210104, 0.045979483249919066, 0.002052812069807938, 0.001091693401271756],
                [-0.0002097482502627844, 0.002052812069807938, 0.016845560433143125, 0.010225807306905454],
                [-0.00010264358905760681, 0.001091693401271756, 0.010225807306905454, 0.007077800371372914]
            ], [
                [0.003422635196015581, -0.0032209052856532767, -1.39815301941015e-05, -9.99260970413752e-06],
                [-0.0032209052856532767, 0.006839391401543439, 2.3311159776708222e-05, -5.616191239811191e-05],
                [-1.39815301941015e-05, 2.3311159776708222e-05, 0.0018716601385022444, 0.001022135426731448],
                [-9.99260970413752e-06, -5.616191239811191e-05, 0.001022135426731448, 0.0007150990959241952]
            ], [
                [0.01145965687215369, -0.008777986288223578, -0.0012724031135282789, -0.0006326119956056747],
                [-0.008777986288223578, 0.013041426332937813, 0.0024406834587570444, 0.0014287594355276935],
                [-0.0012724031135282789, 0.0024406834587570444, 0.007407002973675, 0.003900955856224677],
                [-0.0006326119956056747, 0.0014287594355276935, 0.003900955856224677, 0.0022591791781077122]
            ], [
                [0.005535015521031184, -0.00821906793857138, -0.0014307392572495941, -0.001077024542994729],
                [-0.00821906793857138, 0.018179761764009334, -0.00021975210207021416, 0.0005096433146465212],
                [-0.0014307392572495941, -0.00021975210207021416, 0.01479812250533739, 0.00672475164135033],
                [-0.001077024542994729, 0.0005096433146465212, 0.00672475164135033, 0.0035160180042092936]
            ]
        ]

        covar_determinants = [2.503818305363261e-16, 1.2190023036202048e-19, 3.1646102970796588e-18,
                              1.6173029168915614e-15, 7.164199940608137e-23, 5.175307773962127e-19,
                              4.556970266962947e-18]
        reduced_model_covar_determinants = [2.3422368956389924e-08, 1.0366483271019205e-10, 3.385159012314613e-10,
                                            6.5971093123341194e-09, 3.795131740193036e-12, 1.0013498514757284e-10,
                                            1.903136540430233e-10]

        inverse_covar_matrices = [
            [
                [2068.873414732544, 1255.4300935364158, -1963.9242700193674, -899.2861848713734, 2943.8121086297842,
                 -18.11842323622629, -46.75282329544081],
                [1255.4300935364176, 840.5309754070763, -1159.5277448028896, -582.7343734576117, 1880.8482134394608,
                 -1.209856029795844, -45.93426239559742],
                [-1963.924270019372, -1159.5277448028921, 2260.69439735951, 1164.9790688427831, -3439.8774308672787,
                 -11.217796443903971, 102.21993518921408],
                [-899.2861848713763, -582.7343734576134, 1164.9790688427847, 829.8183055199519, -2024.9846876700792,
                 5.899206356939, 23.723429823435815],
                [2943.8121086297892, 1880.8482134394633, -3439.8774308672796, -2024.9846876700776, 5691.938505647845,
                 20.87227661891154, -169.97575499606316],
                [-18.1184232362252, -1.209856029795154, -11.217796443905163, 5.899206356938324, 20.872276618913467,
                 125.94076035850581, -188.58887613091227],
                [-46.75282329544326, -45.934262395598914, 102.21993518921673, 23.72342982343725, -169.9757549960673,
                 -188.5888761309122, 344.29175117111095]
            ], [
                [1496.8171342767978, 662.6976842414196, -1304.8623387407577, -511.97216740109087, 1525.881512788564,
                 -19.01932632710178, 40.62058341138062],
                [662.6976842414196, 1019.7038491301781, -587.1825030690075, -910.7410766408553, 1286.4838542022464,
                 -12.030451623515988, 4.879721852201644],
                [-1304.8623387407574, -587.1825030690073, 1402.508247992705, 644.852784250863, -1809.592646515749,
                 -40.05350295709109, 98.95634679997286],
                [-511.972167401091, -910.7410766408553, 644.852784250863, 1046.6957342490746, -1463.8829970014046,
                 31.86415218804891, 7.5229977848749],
                [1525.8815127885646, 1286.4838542022471, -1809.5926465157497, -1463.882997001405, 3675.2648696047104,
                 25.163252753528077, -123.65910286095338],
                [-19.01932632710198, -12.030451623516068, -40.053502957090885, 31.864152188048973, 25.163252753527868,
                 926.244183147684, -1295.7181249972296],
                [40.62058341138096, 4.879721852201727, 98.9563467999725, 7.522997784874812, -123.65910286095303,
                 -1295.7181249972296, 2297.2861508510027]
            ], [
                [3566.641419221215, 2357.4022555068473, -3535.6634461645704, -2340.1230192766398, 4165.094929195927,
                 281.8913124117738, -177.04303324748068],
                [2357.402255506847, 1616.3522716738344, -2358.6531869061255, -1598.5760918005492, 2805.7690731949374,
                 166.17966290897363, -112.90274885772979],
                [-3535.66344616457, -2358.653186906125, 3650.5858393100366, 2482.601467857534, -4371.609089839267,
                 -371.82369447210294, 377.16727950404197],
                [-2340.1230192766393, -1598.5760918005485, 2482.601467857534, 1839.2189976468005, -3104.91136013646,
                 -389.17930893138293, 553.5488084958024],
                [4165.094929195926, 2805.769073194937, -4371.609089839267, -3104.91136013646, 5544.619276600624,
                 445.5397307719116, -527.9990393821301],
                [281.8913124117735, 166.17966290897334, -371.8236944721026, -389.1793089313827, 445.5397307719112,
                 1367.4477212970132, -1799.946916540506],
                [-177.04303324748042, -112.90274885772943, 377.16727950404146, 553.5488084958021, -527.9990393821295,
                 -1799.946916540506, 3005.6568743346756]
            ], [
                [138.45733040977768, 52.49166197030999, 10.698163635838378, 67.69308889038926, -73.80075193749911,
                 -6.281354007821093, 8.968326480895424],
                [52.49166197030998, 42.98767388558653, 0.3053692020997214, 24.29285505069042, -6.713500087313867,
                 -11.528166018011973, 11.81780289134441],
                [10.698163635838396, 0.30536920209973306, 183.38976240886416, 123.76636952818404, -334.2315210127521,
                 -1.9894882285774025, 25.863597459344152],
                [67.69308889038932, 24.29285505069043, 123.76636952818403, 184.88694175125684, -327.0919671182833,
                 0.5923982933616394, 20.19195940251452],
                [-73.80075193749921, -6.713500087313899, -334.23152101275207, -327.0919671182833, 930.2791268983273,
                 -57.947644470572264, 21.438319410861116],
                [-6.2813540078210846, -11.528166018011976, -1.9894882285773763, 0.592398293361688, -57.947644470572364,
                 500.44685258771375, -718.1278774079128],
                [8.968326480895406, 11.817802891344401, 25.86359745934414, 20.19195940251447, 21.43831941086117,
                 -718.1278774079127, 1176.6256220992946]
            ], [
                [1006.3552927975084, 550.0220574202741, -15.72087215560552, 536.5682352053572, -468.2750592461094,
                 42.14090059092678, -77.11349505583065],
                [550.0220574202741, 454.9955525534457, -30.824869390689138, 320.25920808365305, -560.1761591509465,
                 1.291707779493946, -6.5477554527813995],
                [-15.720872155605797, -30.82486939068927, 910.0775478277359, 677.9668345841226, -2132.7018191842462,
                 -87.8679749849518, 180.21629321067905],
                [536.5682352053568, 320.2592080836529, 677.9668345841227, 1132.3880512111089, -2099.60632794375,
                 53.35999249053167, -84.57690206876228],
                [-468.27505924610864, -560.1761591509462, -2132.7018191842462, -2099.6063279437494, 98199.81143258142,
                 31.99901751347683, -47.82061078308919],
                [42.140900590926776, 1.2917077794939382, -87.86797498495179, 53.35999249053168, 31.999017513476876,
                 2483.107436202298, -3570.029358229674],
                [-77.11349505583064, -6.547755452781389, 180.21629321067903, -84.5769020687623, -47.820610783089265,
                 -3570.0293582296736, 6540.427969415803]
            ], [
                [205.00181150917652, 170.23139933702384, 32.88630585463846, -45.647878927460724, 129.88239717240631,
                 40.94392154830521, -94.1198301354415],
                [170.23139933702384, 268.1913043512978, 63.528268256564346, -114.05151032615287, 184.2481423635153,
                 17.606962283845238, -95.29085223630386],
                [32.88630585463848, 63.528268256564374, 567.1691665163905, 173.86231833670107, -655.8890732329265,
                 -63.947441313901365, 150.8554575620803],
                [-45.64787892746072, -114.0515103261529, 173.86231833670112, 251.9854685168603, -516.2100745942382,
                 0.807177965354444, 9.35661996544876],
                [129.88239717240623, 184.24814236351529, -655.8890732329265, -516.2100745942381, 2975.337024744881,
                 -43.03197930441705, 86.48196980758944],
                [40.94392154830527, 17.606962283845288, -63.947441313901344, 0.807177965354449, -43.0319793044171,
                 1519.5820887672091, -2641.9542662200624],
                [-94.11983013544159, -95.29085223630389, 150.8554575620802, 9.356619965448743, 86.48196980758954,
                 -2641.9542662200624, 5077.964361009916]
            ], [
                [652.5708257637217, 286.4002385144235, -47.48455983066927, 49.228810423961, -55.04627981628542,
                 -31.47391882814259, 171.9967270203159],
                [286.4002385144234, 211.23320388739023, -142.27157909168542, -62.89344309003439, 157.7662029073319,
                 31.102884999728367, -8.475043878928098],
                [-47.484559830669234, -142.27157909168545, 681.7361833530691, 288.6259242505225, -878.0137380270198,
                 -45.977384612023165, 113.33100464746762],
                [49.22881042396102, -62.89344309003439, 288.6259242505224, 316.5612041253031, -608.7083949126653,
                 -26.32309447729782, -32.81194287975318],
                [-55.04627981628565, 157.76620290733186, -878.0137380270197, -608.7083949126655, 1734.9285691365778,
                 64.59963093205316, -7.237006548432747],
                [-31.473918828142626, 31.10288499972835, -45.97738461202301, -26.323094477297783, 64.59963093205297,
                 543.423684990417, -1051.1088403077301],
                [171.99672702031597, -8.475043878928075, 113.33100464746737, -32.81194287975321, -7.237006548432504,
                 -1051.1088403077301, 2405.02900802712]
            ]
        ]

        inverse_reduced_model_covar_matrices = [
            [
                [272.30326267780845, 182.31115584843502, -40.9422755242826, 76.6767819873952],
                [182.311155848435, 147.0791413150951, -19.97438171879356, 42.4357526142268],
                [-40.9422755242826, -19.974381718793556, 123.75374091281181, -182.33587051944366],
                [76.67678198739519, 42.435752614226786, -182.33587051944366, 324.14126445022674]
            ], [
                [263.832660714436, 190.4267075617705, -60.54314154986999, 134.24800146381887],
                [190.4267075617705, 226.4365429167191, 14.357705669519833, 13.499355824013046],
                [-60.543141549869986, 14.357705669519829, 921.4202872625397, -1289.7990610259646],
                [134.24800146381884, 13.499355824013021, -1289.7990610259646, 2287.4141653649262]
            ], [
                [114.04170782243978, 69.77197663846222, -27.8656714134046, 73.5766995801617],
                [69.77197663846223, 91.21723423340136, -77.70809951925145, 133.28930167443954],
                [-27.865671413404595, -77.70809951925146, 1133.587886910842, -1380.8389578922347],
                [73.5766995801617, 133.28930167443957, -1380.8389578922347, 2208.6649448309]
            ], [
                [101.57463256998027, 37.589836885544, -5.616161059644245, 3.789198247283468],
                [37.589836885544, 35.79182842842991, -7.1014395710954314, 5.28449568345971],
                [-5.616161059644234, -7.101439571095422, 484.1820572478423, -698.5187526738745],
                [3.789198247283438, 5.284495683459693, -698.5187526738745, 1149.7269809780723]
            ], [
                [526.858771197597, 249.29546576348747, -63.27054042503345, 117.37766904547071],
                [249.2954657634875, 264.8275926615559, -66.98465115590159, 120.02773018865659],
                [-63.270540425033474, -66.9846511559016, 2452.0554060986274, -3511.0195735366997],
                [117.37766904547071, 120.02773018865659, -3511.0195735366997, 6427.992165507683]
            ], [
                [183.78116354684408, 126.96929719911408, 54.29495192009049, -122.58816215610592],
                [126.9692971991141, 170.11354555015822, 40.74874088620492, -142.39157094982863],
                [54.2949519200905, 40.74874088620499, 1506.1061646832477, -2611.181189399888],
                [-122.58816215610602, -142.39157094982883, -2611.181189399888, 5007.126137096883]
            ], [
                [621.3501554982278, 274.55496468521744, -32.52919555872185, 212.7506245247155],
                [274.5549646852175, 178.89092239544047, 21.142882920338284, 17.733480323814206],
                [-32.52919555872191, 21.142882920338185, 540.0528321624116, -1045.9364076096142],
                [212.75062452471542, 17.733480323814312, -1045.9364076096144, 2347.4744607103094]
            ]
        ]


def calculate_params(files, exclude_edges=True, exclude_matrix=False, exclude_particle=False, exclude_hidden=False,
                     exclude_1=False, exclude_2=False, exclude_3=False, exclude_4=False, plot=False, scaled_model=False):

    # Accumulate data:
    logger.info('Accumulating data...')
    values = []
    for i in range(0, 7):
        values.append([])
        for j in range(0, 7):
            values[i].append([])
    number_of_files = 0
    number_of_vertices = 0
    for file_ in iter(files.splitlines()):
        print(file_)
        instance = core.SuchSoftware.load(file_)
        number_of_files += 1

        instance.calc_avg_gamma()
        instance.normalize_gamma()
        instance.graph.map_friends()

        for vertex in instance.graph.vertices:
            if not (exclude_edges and vertex.is_edge_column):
                if not (exclude_matrix and not vertex.is_in_precipitate):
                    if not (exclude_particle and vertex.is_in_precipitate):
                        if not (exclude_hidden and not vertex.show_in_overlay):
                            if not (exclude_1 and vertex.flag_1):
                                if not (exclude_2 and vertex.flag_2):
                                    if not (exclude_3 and vertex.flag_3):
                                        if not (exclude_4 and vertex.flag_4):

                                            number_of_vertices += 1

                                            peak_gamma = vertex.normalized_peak_gamma
                                            avg_gamma = vertex.normalized_avg_gamma
                                            alpha = instance.graph.produce_alpha_angles(vertex.i)
                                            theta = instance.graph.produce_theta_angles(vertex.i, exclude_angles_from_inconsistent_meshes=True)
                                            alpha_max = max(alpha)
                                            alpha_min = min(alpha)
                                            if theta:
                                                theta_max = max(theta)
                                                theta_min = min(theta)
                                                theta_mean = utils.mean_val(theta)
                                            else:
                                                theta_max = 0
                                                theta_min = 0
                                                theta_mean = 0

                                            index = -1

                                            if vertex.species() == 'Cu':
                                                index = 0

                                            elif vertex.species() == 'Si':
                                                if vertex.flag_2:
                                                    index = 2
                                                else:
                                                    index = 1

                                            elif vertex.species() == 'Al':
                                                if vertex.is_in_precipitate:
                                                    index = 3
                                                else:
                                                    index = 4

                                            elif vertex.species() == 'Mg':
                                                if alpha_max <= 3.15:
                                                    index = 5
                                                else:
                                                    index = 6

                                            values[index][0].append(alpha_min)
                                            values[index][1].append(alpha_max)
                                            values[index][2].append(theta_min)
                                            values[index][3].append(theta_max)
                                            values[index][4].append(theta_mean)
                                            values[index][5].append(peak_gamma)
                                            values[index][6].append(avg_gamma)

    # Calculate model parameters:
    logger.info('Calculating model parameters...')
    params = []
    covar_matrices = []
    reduced_model_covar_matrices = []
    for i in range(0, 7):
        params.append([])
        covar_matrices.append([])
        reduced_model_covar_matrices.append([])
        for j in range(0, 7):
            covar_matrices[i].append([])
        for j in range(0, 4):
            reduced_model_covar_matrices[i].append([])

    for i, elements in enumerate(values):
        dummy_counter = 0
        for j, data_1 in enumerate(elements):
            if j == 4:
                if scaled_model:
                    params[i].append((utils.mean_val(data_1), 0.2))
                else:
                    params[i].append((utils.mean_val(data_1), 0.1))
            else:
                mean = utils.mean_val(data_1)
                std = np.sqrt(utils.variance(data_1))
                if std < 0.000001:
                    std = 0.01
                if scaled_model:
                    params[i].append((mean, 2 * std))
                else:
                    params[i].append((mean, std))
            for k, data_2 in enumerate(elements):
                if scaled_model:
                    covar_matrices[i][j].append(2 * utils.covariance(data_1, data_2))
                else:
                    covar_matrices[i][j].append(utils.covariance(data_1, data_2))
                if j not in [2, 3, 4] and k not in [2, 3, 4]:
                    reduced_model_covar_matrices[i][dummy_counter].append(covar_matrices[i][j][k])
            if j not in [2, 3, 4]:
                dummy_counter += 1

    # Plot results:
    if plot:
        plot_pane(params, number_of_files, number_of_vertices)

    return params, covar_matrices, reduced_model_covar_matrices


def plot_pane(params, number_of_files, number_of_vertices):
    logger.info('Generating plots...')

    alpha = [
        np.linspace(0.5, 2.5, 1000),
        np.linspace(1.5, 4.5, 1000),
        np.linspace(0.5, 2.5, 1000),
        np.linspace(0.5, 3.5, 1000),
        np.linspace(0.5, 2.5, 1000),
        np.linspace(0, 1, 1000),
        np.linspace(0, 0.8, 1000)
    ]

    fig = plt.figure(constrained_layout=True)
    gs = GridSpec(3, 3, figure=fig)
    ax = [
        fig.add_subplot(gs[0, 0]),
        fig.add_subplot(gs[0, 1]),
        fig.add_subplot(gs[0, 2]),
        fig.add_subplot(gs[1, 0]),
        fig.add_subplot(gs[1, 1]),
        fig.add_subplot(gs[1, 2]),
        fig.add_subplot(gs[2, 1])
    ]

    for i, axis in enumerate(ax):
        axis.plot(alpha[i], utils.normal_dist(alpha[i], params[0][i][0], params[0][i][1]), 'y',
                  label='Cu ($\mu = ${:.2f}, $\sigma = ${:.2f})'.format(params[0][i][0], params[0][i][1]))
        axis.plot(alpha[i], utils.normal_dist(alpha[i], params[1][i][0], params[1][i][1]), 'r',
                  label='Si$_1$ ($\mu = ${:.2f}, $\sigma = ${:.2f})'.format(params[1][i][0], params[1][i][1]))
        axis.plot(alpha[i], utils.normal_dist(alpha[i], params[2][i][0], params[2][i][1]), 'k',
                  label='Si$_2$ ($\mu = ${:.2f}, $\sigma = ${:.2f})'.format(params[2][i][0], params[2][i][1]))
        axis.plot(alpha[i], utils.normal_dist(alpha[i], params[3][i][0], params[3][i][1]), 'g',
                  label='Al$_1$ ($\mu = ${:.2f}, $\sigma = ${:.2f})'.format(params[3][i][0], params[3][i][1]))
        axis.plot(alpha[i], utils.normal_dist(alpha[i], params[4][i][0], params[4][i][1]), 'b',
                  label='Al$_2$ ($\mu = ${:.2f}, $\sigma = ${:.2f})'.format(params[4][i][0], params[4][i][1]))
        axis.plot(alpha[i], utils.normal_dist(alpha[i], params[5][i][0], params[5][i][1]), 'm',
                  label='Mg$_1$ ($\mu = ${:.2f}, $\sigma = ${:.2f})'.format(params[5][i][0], params[5][i][1]))
        axis.plot(alpha[i], utils.normal_dist(alpha[i], params[6][i][0], params[6][i][1]), 'c',
                  label='Mg$_2$ ($\mu = ${:.2f}, $\sigma = ${:.2f})'.format(params[6][i][0], params[6][i][1]))

    ax[0].set_title('Minimum alpha angles fitted density')
    ax[0].set_xlabel('min angle (radians)')
    ax[0].legend()

    ax[1].set_title('Maximum alpha angles fitted density')
    ax[1].set_xlabel('max angle (radians)')
    ax[1].legend()

    ax[2].set_title('Minimum theta angles fitted density')
    ax[2].set_xlabel('min angle (radians)')
    ax[2].legend()

    ax[3].set_title('Maximum theta angles fitted density')
    ax[3].set_xlabel('max angle (radians)')
    ax[3].legend()

    ax[4].set_title('Theta mean fitted density')
    ax[4].set_xlabel('mean angle (radians)')
    ax[4].legend()

    ax[5].set_title('Normalized peak gamma fitted density')
    ax[5].set_xlabel('peak gamma (1)')
    ax[5].legend()

    ax[6].set_title('Normalized average gamma fitted density')
    ax[6].set_xlabel('average gamma (1)')
    ax[6].legend()

    fig.suptitle('98 parameter model fitted densities from {} images'.format(number_of_files))

    logger.info(
        'Plotted parameters over {} files and {} vertices!'.format(number_of_files, number_of_vertices))

    plt.show()


def produce_params(calc=False, files=None, scaled_model=False):
    if calc:

        params, covar_matrices, reduced_model_covar_matrices = calculate_params(files, plot=True, scaled_model=scaled_model)
        covar_determinants = []
        reduced_model_covar_determinants = []
        inverse_covar_matrices = []
        inverse_reduced_model_covar_matrices = []
        for covar_matrix, reduced_model_covar_matrix in zip(covar_matrices, reduced_model_covar_matrices):
            covar_determinants.append(np.linalg.det(np.array(covar_matrix)))
            reduced_model_covar_determinants.append(np.linalg.det(np.array(reduced_model_covar_matrix)))
            inverse_covar_matrices.append(np.linalg.inv(np.array(covar_matrix)).tolist())
            inverse_reduced_model_covar_matrices.append(np.linalg.inv(np.array(reduced_model_covar_matrix)).tolist())

    else:
        if scaled_model:
            params = [
                [(1.9408886686040085, 0.30098937080614985), (2.2535911327737694, 0.40420683897713916), (1.9426871832178674, 0.31416807657348395), (2.185972754735203, 0.27031616804042297), (2.0681158036601834, 0.2), (0.5230036583576926, 0.4371409591520535),
                         (0.4773723317750351, 0.2713851093634729)],
                        [(1.936787652887436, 0.20303880182118578), (2.2615634606546244, 0.2165983007713216),
                         (1.9334009630656765, 0.23115900929913927), (2.2578311663298805, 0.2151547348035592),
                         (2.0904260112548094, 0.2), (0.32140822912633593, 0.14437401306865938),
                         (0.3184091895760189, 0.092015025322881)],
                        [(1.6009637276546127, 0.2591154185085752), (2.4523171361889986, 0.2987033778568992),
                         (1.6075572660229427, 0.2836853136038702), (2.4291771316372976, 0.2669363438250942),
                         (2.0863607470375145, 0.2), (0.3316555674142397, 0.1224445637976125),
                         (0.323362273836677, 0.08874606465059674)],
                        [(1.463591389444738, 0.253828981840592), (3.1290401807096724, 0.4288565412812031),
                         (1.371675745222616, 0.26267735241984946), (1.7619462932442616, 0.27370902510514317),
                         (1.5684722988700075, 0.2), (0.28771963483166313, 0.25958089631668296),
                         (0.30733295088517604, 0.16825932807868826)],
                        [(1.5369446604765007, 0.11700658436200215), (3.113033828349521, 0.16540122613261898),
                         (1.4845547385950848, 0.11053166898322755), (1.6584770380431877, 0.11352455011254117),
                         (1.5707611373231825, 0.2), (0.30207150582056175, 0.08652537520293672),
                         (0.3077100743414327, 0.05348267367752645)],
                        [(1.2507724368012618, 0.2140995737702781), (2.627846264707654, 0.22839812900229994),
                         (1.1293956087442933, 0.1168804498884407), (1.4163905045201246, 0.19810078629873712),
                         (1.2568266816038394, 0.2), (0.19098316926110578, 0.1721278940053006),
                         (0.24219478439697908, 0.09506164690573611)],
                        [(1.2327186353296424, 0.14879536983429537), (3.7214179486851084, 0.26966469375140184),
                         (1.1003855264090439, 0.14521565467760386), (1.4334789287325416, 0.21499363054433268),
                         (1.2556838814607734, 0.2), (0.14417280294967982, 0.24329506781139146),
                         (0.2188545322900716, 0.11859204027605383)]]

            covar_matrices = [[[0.04529730066914099, -0.05529025444176951, 0.0400670756158686, 0.0031189248242379512,
                                  0.020134891852264115, 0.005486791515675408, -0.0003903507361269191],
                                 [-0.05529025444176951, 0.08169158433794546, -0.05143667357669071,
                                  -0.017184966255983425, -0.03564884835645986, -0.009309594880235675,
                                  -0.0028525777673186],
                                 [0.0400670756158686, -0.05143667357669071, 0.049350790168941235, 0.012775641170641538,
                                  0.030680495746352256, 0.0071007157957692635, 0.0020821965190538725],
                                 [0.0031189248242379512, -0.017184966255983425, 0.012775641170641538,
                                  0.036535415352029095, 0.02503785186605559, 0.010135300886981427,
                                  0.009733030151952092],
                                 [0.020134891852264115, -0.03564884835645986, 0.030680495746352256, 0.02503785186605559,
                                  0.029334410958230125, 0.009387868848108358, 0.0067683984739360025],
                                 [0.005486791515675408, -0.009309594880235675, 0.0071007157957692635,
                                  0.010135300886981427, 0.009387868848108358, 0.09554610908418865, 0.05366744389220178],
                                 [-0.0003903507361269191, -0.0028525777673186, 0.0020821965190538725,
                                  0.009733030151952092, 0.0067683984739360025, 0.05366744389220178,
                                  0.036824938792112065]], [
                                    [0.020612377522491374, -0.017302245956463347, 0.021627865927428682,
                                     -0.015696360810495077, 0.0018626105967175072, 0.0003489292584513981,
                                     -0.0009108768821687425],
                                    [-0.017302245956463347, 0.02345741194851195, -0.01781801565634886,
                                     0.020941616338189216, -0.0014456999937880624, -0.001303844375456398,
                                     0.000141834716078984],
                                    [0.021627865927428682, -0.01781801565634886, 0.026717243790079778,
                                     -0.015527704173445915, 0.004191382123047323, 0.0003938986023098285,
                                     -0.000996798512509196],
                                    [-0.015696360810495077, 0.020941616338189216, -0.015527704173445915,
                                     0.023145779954194947, 0.000770607953504813, -0.001541590453673141,
                                     -1.8842691387055356e-06],
                                    [0.0018626105967175072, -0.0014456999937880624, 0.004191382123047323,
                                     0.000770607953504813, 0.0026454076195710943, 1.7386845040225155e-05,
                                     -6.072803637355372e-05],
                                    [0.0003489292584513981, -0.001303844375456398, 0.0003938986023098285,
                                     -0.001541590453673141, 1.7386845040225155e-05, 0.010421927824774715,
                                     0.005863805046384774],
                                    [-0.0009108768821687425, 0.000141834716078984, -0.000996798512509196,
                                     -1.8842691387055356e-06, -6.072803637355372e-05, 0.005863805046384774,
                                     0.004233382442585216]], [
                                    [0.03357040005443704, -0.026253806474159952, 0.024660650771387974,
                                     -0.013881555489244135, -0.00018270781555547948, -0.0017059975338508584,
                                     -0.0006005236639753832],
                                    [-0.026253806474159952, 0.04461185397156075, -0.0031965822579452653,
                                     0.01572010511691184, 0.003238896657062335, 0.0008332217549361968,
                                     -0.001296742349902455],
                                    [0.024660650771387974, -0.0031965822579452653, 0.04023867857726309,
                                     -0.012837643741425838, 0.007618098787225221, 0.00043244311405308167,
                                     0.0002446608111720475],
                                    [-0.013881555489244135, 0.01572010511691184, -0.012837643741425838,
                                     0.03562750582735445, 0.012049646982772647, -0.0016760691763468593,
                                     -0.004064684649664654],
                                    [-0.00018270781555547948, 0.003238896657062335, 0.007618098787225221,
                                     0.012049646982772647, 0.01151130627680366, 0.00010682911243296434,
                                     -0.000978084615077556],
                                    [-0.0017059975338508584, 0.0008332217549361968, 0.00043244311405308167,
                                     -0.0016760691763468593, 0.00010682911243296434, 0.007496335601793798,
                                     0.004693194586543443],
                                    [-0.0006005236639753832, -0.001296742349902455, 0.0002446608111720475,
                                     -0.004064684649664654, -0.000978084615077556, 0.004693194586543443,
                                     0.003937931995483948]], [
                                    [0.03221457601111579, -0.03388580300842021, 0.007801050527656686,
                                     -0.009343673473272104, 0.0018071739629549836, -0.0004194965005255688,
                                     -0.00020528717811521362],
                                    [-0.03388580300842021, 0.09195896649983813, -0.004300974497141198,
                                     -0.007939237652562065, -0.006155905310275833, 0.004105624139615876,
                                     0.002183386802543512],
                                    [0.007801050527656686, -0.004300974497141198, 0.03449969573715089,
                                     -0.005996195358594148, 0.010957406319056033, 0.001300370717599889,
                                     -7.769805495931932e-05],
                                    [-0.009343673473272104, -0.007939237652562065, -0.005996195358594148,
                                     0.03745831521200394, 0.010243225520989956, 0.0002677574299024161,
                                     -0.00038327025549235753],
                                    [0.0018071739629549836, -0.006155905310275833, 0.010957406319056033,
                                     0.010243225520989956, 0.009905229977877718, 0.0021850248238076456,
                                     0.0007845222360666921],
                                    [-0.0004194965005255688, 0.004105624139615876, 0.001300370717599889,
                                     0.0002677574299024161, 0.0021850248238076456, 0.03369112086628625,
                                     0.020451614613810908],
                                    [-0.00020528717811521362, 0.002183386802543512, -7.769805495931932e-05,
                                     -0.00038327025549235753, 0.0007845222360666921, 0.020451614613810908,
                                     0.014155600742745827]], [
                                    [0.006845270392031162, -0.006441810571306553, 0.0016988499181489292,
                                     -0.002476349127575107, -2.015643593393712e-05, -2.7963060388203e-05,
                                     -1.998521940827504e-05],
                                    [-0.006441810571306553, 0.013678782803086879, 0.001879312991720812,
                                     -0.0018625354670455231, 4.8233784136319316e-05, 4.662231955341664e-05,
                                     -0.00011232382479622367],
                                    [0.0016988499181489292, 0.001879312991720812, 0.006108624924108894,
                                     -0.004923610388264799, 4.611771618486837e-05, -4.6389046761473246e-05,
                                     -0.00023505996948356773],
                                    [-0.002476349127575107, -0.0018625354670455231, -0.004923610388264799,
                                     0.0064439117391274356, 8.50410749040008e-06, 2.1792041828126476e-06,
                                     0.00018918517913982607],
                                    [-2.015643593393712e-05, 4.8233784136319316e-05, 4.611771618486837e-05,
                                     8.50410749040008e-06, 2.1728560201789663e-05, -1.052553097241618e-06,
                                     -1.7657858915954534e-06],
                                    [-2.7963060388203e-05, 4.662231955341664e-05, -4.6389046761473246e-05,
                                     2.1792041828126476e-06, -1.052553097241618e-06, 0.003743320277004489,
                                     0.002044270853462896],
                                    [-1.998521940827504e-05, -0.00011232382479622367, -0.00023505996948356773,
                                     0.00018918517913982607, -1.7657858915954534e-06, 0.002044270853462896,
                                     0.0014301981918483904]], [
                                    [0.02291931374430738, -0.017555972576447157, 0.0019442477881966048,
                                     -0.006244380590629985, -0.0005681542421716117, -0.0025448062270565577,
                                     -0.0012652239912113493],
                                    [-0.017555972576447157, 0.026082852665875626, -0.0059731513213857335,
                                     0.012663801114189011, 1.9118070994631004e-05, 0.004881366917514089,
                                     0.002857518871055387],
                                    [0.0019442477881966048, -0.0059731513213857335, 0.006830519783062147,
                                     -0.005162213843933554, 0.0009045279514128836, -0.001704152675301568,
                                     -0.0011714996580109909],
                                    [-0.006244380590629985, 0.012663801114189011, -0.005162213843933554,
                                     0.019621960766088953, 0.0017472303418881927, 0.0021721607956365695,
                                     0.0013394782510342009],
                                    [-0.0005681542421716117, 1.9118070994631004e-05, 0.0009045279514128836,
                                     0.0017472303418881927, 0.0012002425032096153, -0.0002025147998181329,
                                     -0.00016606814603240412],
                                    [-0.0025448062270565577, 0.004881366917514089, -0.001704152675301568,
                                     0.0021721607956365695, -0.0002025147998181329, 0.01481400594735,
                                     0.007801911712449354],
                                    [-0.0012652239912113493, 0.002857518871055387, -0.0011714996580109909,
                                     0.0013394782510342009, -0.00016606814603240412, 0.007801911712449354,
                                     0.0045183583562154244]], [
                                    [0.011070031042062368, -0.01643813587714276, -0.00041140855665823377,
                                     -0.005337504096422442, -0.00013729557813195586, -0.0028614785144991882,
                                     -0.002154049085989458],
                                    [-0.01643813587714276, 0.03635952352801867, 0.004555646056535607,
                                     0.008630311154456822, 0.0015262120414996614, -0.0004395042041404283,
                                     0.0010192866292930425],
                                    [-0.00041140855665823377, 0.004555646056535607, 0.010543793181722544,
                                     0.0013473364539841551, 0.005561360536450435, -0.005130790363471004,
                                     -0.002658650355867108],
                                    [-0.005337504096422442, 0.008630311154456822, 0.0013473364539841551,
                                     0.02311113058731651, 0.007644518267963169, 0.005498604468960173,
                                     0.0030900902958734986],
                                    [-0.00013729557813195586, 0.0015262120414996614, 0.005561360536450435,
                                     0.007644518267963169, 0.0065682147860185195, -0.0017641100497350769,
                                     -0.0008938068621698029],
                                    [-0.0028614785144991882, -0.0004395042041404283, -0.005130790363471004,
                                     0.005498604468960173, -0.0017641100497350769, 0.02959624501067478,
                                     0.01344950328270066],
                                    [-0.002154049085989458, 0.0010192866292930425, -0.002658650355867108,
                                     0.0030900902958734986, -0.0008938068621698029, 0.01344950328270066,
                                     0.007032036008418587]]]

            reduced_model_covar_matrices = [
                [[0.09059460133828198, -0.11058050888353901, 0.010973583031350816, -0.0007807014722538382],
                 [-0.11058050888353901, 0.16338316867589092, -0.01861918976047135, -0.0057051555346372],
                 [0.010973583031350816, -0.01861918976047135, 0.1910922181683773, 0.10733488778440356],
                 [-0.0007807014722538382, -0.0057051555346372, 0.10733488778440356, 0.07364987758422413]],
                [[0.04122475504498275, -0.034604491912926694, 0.0006978585169027962, -0.001821753764337485],
                 [-0.034604491912926694, 0.0469148238970239, -0.002607688750912796, 0.000283669432157968],
                 [0.0006978585169027962, -0.002607688750912796, 0.02084385564954943, 0.011727610092769548],
                 [-0.001821753764337485, 0.000283669432157968, 0.011727610092769548, 0.008466764885170432]],
                [[0.06714080010887408, -0.052507612948319904, -0.0034119950677017168, -0.0012010473279507664],
                 [-0.052507612948319904, 0.0892237079431215, 0.0016664435098723935, -0.00259348469980491],
                 [-0.0034119950677017168, 0.0016664435098723935, 0.014992671203587596, 0.009386389173086885],
                 [-0.0012010473279507664, -0.00259348469980491, 0.009386389173086885, 0.007875863990967897]],
                [[0.06442915202223158, -0.06777160601684042, -0.0008389930010511376, -0.00041057435623042724],
                 [-0.06777160601684042, 0.18391793299967626, 0.008211248279231751, 0.004366773605087024],
                 [-0.0008389930010511376, 0.008211248279231751, 0.0673822417325725, 0.040903229227621817],
                 [-0.00041057435623042724, 0.004366773605087024, 0.040903229227621817, 0.028311201485491655]],
                [[0.013690540784062325, -0.012883621142613107, -5.5926120776406e-05, -3.997043881655008e-05],
                 [-0.012883621142613107, 0.027357565606173757, 9.324463910683328e-05, -0.00022464764959244734],
                 [-5.5926120776406e-05, 9.324463910683328e-05, 0.007486640554008978, 0.004088541706925792],
                 [-3.997043881655008e-05, -0.00022464764959244734, 0.004088541706925792, 0.002860396383696781]],
                [[0.04583862748861476, -0.035111945152894314, -0.0050896124541131155, -0.0025304479824226987],
                 [-0.035111945152894314, 0.05216570533175125, 0.009762733835028178, 0.005715037742110774],
                 [-0.0050896124541131155, 0.009762733835028178, 0.0296280118947, 0.015603823424898708],
                 [-0.0025304479824226987, 0.005715037742110774, 0.015603823424898708, 0.009036716712430849]],
                [[0.022140062084124737, -0.03287627175428552, -0.0057229570289983765, -0.004308098171978916],
                 [-0.03287627175428552, 0.07271904705603734, -0.0008790084082808566, 0.002038573258586085],
                 [-0.0057229570289983765, -0.0008790084082808566, 0.05919249002134956, 0.02689900656540132],
                 [-0.004308098171978916, 0.002038573258586085, 0.02689900656540132, 0.014064072016837174]]]

            covar_determinants = [3.2048874308650046e-14, 1.5603229486338825e-17, 4.0507011802619297e-16,
                                    2.070147733621196e-13, 9.170175923978405e-21, 6.624393950671515e-17,
                                    5.832921941712607e-16]

            reduced_model_covar_determinants = [5.996126452835814e-06, 2.6538197173809185e-08, 8.666007071525415e-08,
                                                  1.6888599839575329e-06, 9.71553725489418e-10, 2.5634556197778575e-08,
                                                  4.8720295435014e-08]

            inverse_covar_matrices = [[[1034.4367073662665, 627.7150467682048, -981.9621350096764,
                                          -449.64309243568226, 1471.9060543148782, -9.059211618113146,
                                          -23.376411647719646],
                                         [627.7150467682054, 420.265487703536, -579.7638724014405, -291.36718672880323,
                                          940.4241067197219, -0.6049280148979187, -22.967131197798224],
                                         [-981.9621350096795, -579.7638724014422, 1130.3471986797467, 582.4895344213865,
                                          -1719.9387154336257, -5.608898221951981, 51.10996759460616],
                                         [-449.6430924356848, -291.36718672880454, 582.4895344213884,
                                          414.90915275997327, -1012.4923438350328, 2.949603178469497,
                                          11.86171491171739],
                                         [1471.9060543148844, 940.4241067197254, -1719.9387154336273,
                                          -1012.492343835031, 2845.9692528239016, 10.436138309455774,
                                          -84.98787749803013],
                                         [-9.059211618112593, -0.6049280148975663, -5.6088982219525905,
                                          2.949603178469157, 10.436138309456757, 62.97038017925291, -94.29443806545615],
                                         [-23.376411647721383, -22.967131197799322, 51.10996759460806,
                                          11.861714911718442, -84.98787749803319, -94.29443806545612,
                                          172.14587558555547]], [
                                            [748.408567138398, 331.34884212070943, -652.431169370378,
                                             -255.9860837005452, 762.9407563942815, -9.50966316355092,
                                             20.310291705690364],
                                            [331.34884212070926, 509.851924565089, -293.59125153450316,
                                             -455.37053832042767, 643.2419271011229, -6.015225811758024,
                                             2.4398609261008493],
                                            [-652.4311693703779, -293.5912515345034, 701.2541239963517,
                                             322.4263921254312, -904.7963232578737, -20.026751478545506,
                                             49.47817339998635],
                                            [-255.986083700545, -455.3705383204276, 322.426392125431, 523.3478671245373,
                                             -731.9414985007019, 15.932076094024486, 3.7614988924374173],
                                            [762.9407563942813, 643.2419271011232, -904.7963232578736,
                                             -731.9414985007022, 1837.6324348023538, 12.581626376763978,
                                             -61.82955143047659],
                                            [-9.509663163550977, -6.015225811758078, -20.02675147854543,
                                             15.932076094024548, 12.581626376763882, 463.1220915738419,
                                             -647.8590624986145],
                                            [20.310291705690467, 2.439860926100924, 49.47817339998622,
                                             3.7614988924373263, -61.829551430476435, -647.8590624986145,
                                             1148.643075425501]], [
                                            [1783.3207096106078, 1178.7011277534232, -1767.8317230822843,
                                             -1170.0615096383192, 2082.5474645979625, 140.9456562058867,
                                             -88.52151662374035],
                                            [1178.7011277534236, 808.1761358369171, -1179.326593453062,
                                             -799.2880459002741, 1402.8845365974682, 83.0898314544867,
                                             -56.45137442886488],
                                            [-1767.831723082285, -1179.326593453062, 1825.2929196550174,
                                             1241.3007339287662, -2185.804544919633, -185.91184723605127,
                                             188.5836397520209],
                                            [-1170.0615096383194, -799.2880459002741, 1241.300733928766,
                                             919.6094988233999, -1552.4556800682294, -194.5896544656913,
                                             276.77440424790103],
                                            [2082.547464597963, 1402.884536597468, -2185.8045449196325,
                                             -1552.4556800682296, 2772.3096383003117, 222.7698653859556,
                                             -263.99951969106496],
                                            [140.94565620588588, 83.08983145448612, -185.9118472360504,
                                             -194.58965446569067, 222.7698653859545, 683.7238606485062,
                                             -899.9734582702525],
                                            [-88.5215166237387, -56.451374428863765, 188.58363975201922,
                                             276.7744042478999, -263.99951969106286, -899.9734582702524,
                                             1502.828437167337]], [
                                            [69.22866520488884, 26.245830985154996, 5.349081817919197,
                                             33.846544445194624, -36.90037596874956, -3.1406770039105565,
                                             4.48416324044772],
                                            [26.24583098515499, 21.493836942793266, 0.15268460104986487,
                                             12.146427525345205, -3.3567500436569375, -5.764083009006005,
                                             5.908901445672219],
                                            [5.349081817919201, 0.1526846010498659, 91.69488120443208,
                                             61.88318476409202, -167.11576050637606, -0.9947441142887111,
                                             12.931798729672126],
                                            [33.84654444519466, 12.146427525345215, 61.88318476409202,
                                             92.44347087562842, -163.54598355914166, 0.2961991466808155,
                                             10.095979701257301],
                                            [-36.900375968749614, -3.3567500436569455, -167.11576050637603,
                                             -163.54598355914166, 465.1395634491636, -28.973822235286207,
                                             10.719159705430558],
                                            [-3.140677003910548, -5.7640830090060025, -0.9947441142887123,
                                             0.2961991466808233, -28.973822235286192, 250.22342629385767,
                                             -359.0639387039575],
                                            [4.484163240447715, 5.908901445672225, 12.931798729672108,
                                             10.095979701257269, 10.719159705430604, -359.06393870395755,
                                             588.3128110496491]], [
                                            [503.1776463987542, 275.01102871013705, -7.860436077802793,
                                             268.28411760267846, -234.1375296230545, 21.070450295463374,
                                             -38.55674752791534],
                                            [275.01102871013705, 227.49777627672285, -15.412434695344569,
                                             160.12960404182647, -280.08807957547316, 0.645853889746973,
                                             -3.273877726390729],
                                            [-7.860436077802898, -15.41243469534462, 455.03877391386794,
                                             338.9834172920613, -1066.350909592123, -43.93398749247585,
                                             90.10814660533947],
                                            [268.28411760267835, 160.1296040418264, 338.9834172920613,
                                             566.1940256055543, -1049.8031639718745, 26.679996245265826,
                                             -42.28845103438114],
                                            [-234.13752962305418, -280.088079575473, -1066.350909592123,
                                             -1049.8031639718743, 49099.905716290705, 15.999508756738416,
                                             -23.91030539154457],
                                            [21.070450295463367, 0.6458538897469573, -43.93398749247588,
                                             26.679996245265787, 15.999508756738482, 1241.5537181011482,
                                             -1785.0146791148356],
                                            [-38.55674752791531, -3.273877726390695, 90.1081466053395,
                                             -42.288451034381076, -23.910305391544686, -1785.0146791148352,
                                             3270.2139847078993]], [
                                            [102.50090575458826, 85.11569966851192, 16.44315292731925,
                                             -22.823939463730362, 64.94119858620309, 20.471960774152592,
                                             -47.05991506772069],
                                            [85.11569966851192, 134.0956521756489, 31.76413412828221,
                                             -57.02575516307644, 92.12407118175757, 8.80348114192259,
                                             -47.64542611815188],
                                            [16.443152927319247, 31.764134128282187, 283.58458325819527,
                                             86.93115916835052, -327.94453661646304, -31.973720656950626,
                                             75.42772878104003],
                                            [-22.82393946373036, -57.02575516307645, 86.93115916835052,
                                             125.99273425843015, -258.1050372971189, 0.4035889826772575,
                                             4.678309982724322],
                                            [64.9411985862031, 92.1240711817576, -327.94453661646304,
                                             -258.10503729711894, 1487.6685123724394, -21.515989652208543,
                                             43.240984903794754],
                                            [20.47196077415259, 8.803481141922607, -31.973720656950697,
                                             0.4035889826771782, -21.515989652208372, 759.7910443836039,
                                             -1320.9771331100296],
                                            [-47.05991506772071, -47.645426118151875, 75.42772878104014,
                                             4.678309982724457, 43.24098490379444, -1320.9771331100299,
                                             2538.982180504955]], [
                                            [326.28541288186085, 143.20011925721175, -23.742279915334635,
                                             24.614405211980515, -27.523139908142845, -15.736959414071269,
                                             85.99836351015786],
                                            [143.2001192572117, 105.61660194369512, -71.13578954584273,
                                             -31.446721545017187, 78.88310145366589, 15.551442499864166,
                                             -4.2375219394640435],
                                            [-23.74227991533462, -71.13578954584273, 340.8680916765346,
                                             144.3129621252612, -439.0068690135098, -22.988692306011554,
                                             56.665502323733804],
                                            [24.61440521198051, -31.446721545017194, 144.3129621252612,
                                             158.28060206265155, -304.35419745633266, -13.161547238648893,
                                             -16.405971439876613],
                                            [-27.52313990814282, 78.88310145366593, -439.00686901350986,
                                             -304.3541974563327, 867.4642845682889, 32.29981546602653,
                                             -3.6185032742163736],
                                            [-15.736959414071292, 15.551442499864168, -22.988692306011547,
                                             -13.161547238648927, 32.29981546602655, 271.7118424952082,
                                             -525.5544201538645],
                                            [85.99836351015794, -4.237521939464027, 56.665502323733776,
                                             -16.405971439876527, -3.6185032742163896, -525.5544201538645,
                                             1202.514504013559]]]

            inverse_reduced_model_covar_matrices = [
                [[68.07581566945211, 45.577788962108755, -10.23556888107065, 19.1691954968488],
                 [45.57778896210875, 36.76978532877377, -4.99359542969839, 10.6089381535567],
                 [-10.23556888107065, -4.993595429698389, 30.938435228202952, -45.583967629860915],
                 [19.169195496848797, 10.608938153556696, -45.583967629860915, 81.03531611255669]],
                [[65.958165178609, 47.60667689044263, -15.135785387467493, 33.5620003659547],
                 [47.60667689044263, 56.609135729179776, 3.589426417379952, 3.3748389560032614],
                 [-15.135785387467493, 3.5894264173799537, 230.35507181563474, -322.449765256491],
                 [33.5620003659547, 3.3748389560032614, -322.44976525649093, 571.8535413412313]],
                [[28.510426955609944, 17.442994159615555, -6.96641785335115, 18.394174895040425],
                 [17.44299415961556, 22.80430855835034, -19.427024879812862, 33.322325418609886],
                 [-6.966417853351149, -19.427024879812866, 283.3969717277105, -345.2097394730587],
                 [18.394174895040425, 33.32232541860989, -345.2097394730587, 552.166236207725]],
                [[25.393658142495067, 9.397459221386, -1.4040402649110613, 0.947299561820867],
                 [9.397459221386, 8.947957107107477, -1.7753598927738579, 1.3211239208649275],
                 [-1.4040402649110586, -1.7753598927738554, 121.04551431196057, -174.62968816846862],
                 [0.9472995618208595, 1.3211239208649233, -174.62968816846862, 287.4317452445181]],
                [[131.71469279939924, 62.32386644087187, -15.817635106258367, 29.344417261367667],
                 [62.323866440871875, 66.20689816538898, -16.7461627889754, 30.006932547164137],
                 [-15.817635106258367, -16.746162788975404, 613.0138515246568, -877.7548933841749],
                 [29.34441726136767, 30.006932547164144, -877.7548933841749, 1606.9980413769208]],
                [[45.94529088671102, 31.74232429977852, 13.573737980022623, -30.64704053902648],
                 [31.742324299778524, 42.528386387539555, 10.18718522155123, -35.59789273745716],
                 [13.573737980022624, 10.187185221551248, 376.5265411708119, -652.795297349972],
                 [-30.647040539026506, -35.59789273745721, -652.795297349972, 1251.7815342742208]],
                [[155.33753887455694, 68.63874117130436, -8.132298889680463, 53.187656131178876],
                 [68.63874117130437, 44.72273059886012, 5.285720730084571, 4.4333700809535515],
                 [-8.132298889680477, 5.285720730084546, 135.0132080406029, -261.48410190240355],
                 [53.187656131178855, 4.433370080953578, -261.4841019024036, 586.8686151775773]]]

        else:
            params = [
                [(1.94, 0.15), (2.25, 0.20), (1.94, 0.16), (2.19, 0.13), (2.07, 0.15), (0.52, 0.22), (0.48, 0.14)],
                [(1.94, 0.10), (2.26, 0.11), (1.93, 0.12), (2.26, 0.11), (2.09, 0.15), (0.32, 0.07), (0.32, 0.05)],
                [(1.60, 0.13), (2.45, 0.15), (1.61, 0.14), (2.43, 0.13), (2.09, 0.15), (0.33, 0.06), (0.32, 0.04)],
                [(1.46, 0.13), (3.13, 0.21), (1.37, 0.13), (1.76, 0.14), (1.57, 0.15), (0.29, 0.13), (0.31, 0.08)],
                [(1.54, 0.13), (3.11, 0.08), (1.48, 0.06), (1.66, 0.06), (1.57, 0.15), (0.30, 0.04), (0.31, 0.03)],
                [(1.25, 0.11), (2.63, 0.11), (1.13, 0.06), (1.42, 0.10), (1.26, 0.15), (0.19, 0.09), (0.24, 0.05)],
                [(1.23, 0.07), (3.72, 0.13), (1.10, 0.07), (1.43, 0.11), (1.26, 0.15), (0.14, 0.12), (0.22, 0.06)]
            ]

            covar_matrices = [
                [
                    [0.022648650334570496, -0.027645127220884753, 0.0200335378079343, 0.0015594624121189756, 0.010067445926132058, 0.002743395757837704, -0.00019517536806345955],
                    [-0.027645127220884753, 0.04084579216897273, -0.025718336788345356, -0.008592483127991712, -0.01782442417822993, -0.004654797440117838, -0.0014262888836593],
                    [0.0200335378079343, -0.025718336788345356, 0.024675395084470617, 0.006387820585320769, 0.015340247873176128, 0.0035503578978846317, 0.0010410982595269362],
                    [0.0015594624121189756, -0.008592483127991712, 0.006387820585320769, 0.018267707676014548, 0.012518925933027796, 0.005067650443490714, 0.004866515075976046],
                    [0.010067445926132058, -0.01782442417822993, 0.015340247873176128, 0.012518925933027796, 0.014667205479115063, 0.004693934424054179, 0.0033841992369680013],
                    [0.002743395757837704, -0.004654797440117838, 0.0035503578978846317, 0.005067650443490714, 0.004693934424054179, 0.04777305454209432, 0.02683372194610089],
                    [-0.00019517536806345955, -0.0014262888836593, 0.0010410982595269362, 0.004866515075976046, 0.0033841992369680013, 0.02683372194610089, 0.018412469396056032]
                ], [
                    [0.010306188761245687, -0.008651122978231673, 0.010813932963714341, -0.007848180405247538, 0.0009313052983587536, 0.00017446462922569904, -0.00045543844108437124],
                    [-0.008651122978231673, 0.011728705974255975, -0.00890900782817443, 0.010470808169094608, -0.0007228499968940312, -0.000651922187728199, 7.0917358039492e-05],
                    [0.010813932963714341, -0.00890900782817443, 0.013358621895039889, -0.007763852086722958, 0.0020956910615236614, 0.00019694930115491424, -0.000498399256254598],
                    [-0.007848180405247538, 0.010470808169094608, -0.007763852086722958, 0.011572889977097474, 0.0003853039767524065, -0.0007707952268365705, -9.421345693527678e-07],
                    [0.0009313052983587536, -0.0007228499968940312, 0.0020956910615236614, 0.0003853039767524065, 0.0013227038097855472, 8.693422520112577e-06, -3.036401818677686e-05],
                    [0.00017446462922569904, -0.000651922187728199, 0.00019694930115491424, -0.0007707952268365705, 8.693422520112577e-06, 0.005210963912387357, 0.002931902523192387],
                    [-0.00045543844108437124, 7.0917358039492e-05, -0.000498399256254598, -9.421345693527678e-07, -3.036401818677686e-05, 0.002931902523192387, 0.002116691221292608]
                ], [
                    [0.01678520002721852, -0.013126903237079976, 0.012330325385693987, -0.0069407777446220675, -9.135390777773974e-05, -0.0008529987669254292, -0.0003002618319876916],
                    [-0.013126903237079976, 0.022305926985780374, -0.0015982911289726327, 0.00786005255845592, 0.0016194483285311674, 0.0004166108774680984, -0.0006483711749512275],
                    [0.012330325385693987, -0.0015982911289726327, 0.020119339288631546, -0.006418821870712919, 0.0038090493936126105, 0.00021622155702654083, 0.00012233040558602375],
                    [-0.0069407777446220675, 0.00786005255845592, -0.006418821870712919, 0.017813752913677226, 0.0060248234913863235, -0.0008380345881734296, -0.002032342324832327],
                    [-9.135390777773974e-05, 0.0016194483285311674, 0.0038090493936126105, 0.0060248234913863235, 0.00575565313840183, 5.341455621648217e-05, -0.000489042307538778],
                    [-0.0008529987669254292, 0.0004166108774680984, 0.00021622155702654083, -0.0008380345881734296, 5.341455621648217e-05, 0.003748167800896899, 0.0023465972932717213],
                    [-0.0003002618319876916, -0.0006483711749512275, 0.00012233040558602375, -0.002032342324832327, -0.000489042307538778, 0.0023465972932717213, 0.001968965997741974]
                ], [
                    [0.016107288005557895, -0.016942901504210104, 0.003900525263828343, -0.004671836736636052, 0.0009035869814774918, -0.0002097482502627844, -0.00010264358905760681],
                    [-0.016942901504210104, 0.045979483249919066, -0.002150487248570599, -0.003969618826281033, -0.0030779526551379167, 0.002052812069807938, 0.001091693401271756],
                    [0.003900525263828343, -0.002150487248570599, 0.017249847868575446, -0.002998097679297074, 0.005478703159528016, 0.0006501853587999445, -3.884902747965966e-05],
                    [-0.004671836736636052, -0.003969618826281033, -0.002998097679297074, 0.01872915760600197, 0.005121612760494978, 0.00013387871495120805, -0.00019163512774617877],
                    [0.0009035869814774918, -0.0030779526551379167, 0.005478703159528016, 0.005121612760494978, 0.004952614988938859, 0.0010925124119038228, 0.00039226111803334604],
                    [-0.0002097482502627844, 0.002052812069807938, 0.0006501853587999445, 0.00013387871495120805, 0.0010925124119038228, 0.016845560433143125, 0.010225807306905454],
                    [-0.00010264358905760681, 0.001091693401271756, -3.884902747965966e-05, -0.00019163512774617877, 0.00039226111803334604, 0.010225807306905454, 0.007077800371372914]
                ], [
                    [0.003422635196015581, -0.0032209052856532767, 0.0008494249590744646, -0.0012381745637875534, -1.007821796696856e-05, -1.39815301941015e-05, -9.99260970413752e-06],
                    [-0.0032209052856532767, 0.006839391401543439, 0.0009396564958604061, -0.0009312677335227616, 2.4116892068159658e-05, 2.3311159776708222e-05, -5.616191239811191e-05],
                    [0.0008494249590744646, 0.0009396564958604061, 0.003054312462054447, -0.0024618051941323995, 2.3058858092434184e-05, -2.3194523380736623e-05, -0.00011752998474178386],
                    [-0.0012381745637875534, -0.0009312677335227616, -0.0024618051941323995, 0.0032219558695637178, 4.25205374520004e-06, 1.0896020914063238e-06, 9.459258956991304e-05],
                    [-1.007821796696856e-05, 2.4116892068159658e-05, 2.3058858092434184e-05, 4.25205374520004e-06, 1.0864280100894832e-05, -5.26276548620809e-07, -8.828929457977267e-07],
                    [-1.39815301941015e-05, 2.3311159776708222e-05, -2.3194523380736623e-05, 1.0896020914063238e-06, -5.26276548620809e-07, 0.0018716601385022444, 0.001022135426731448],
                    [-9.99260970413752e-06, -5.616191239811191e-05, -0.00011752998474178386, 9.459258956991304e-05, -8.828929457977267e-07, 0.001022135426731448, 0.0007150990959241952]
                ], [
                    [0.01145965687215369, -0.008777986288223578, 0.0009721238940983024, -0.0031221902953149925, -0.00028407712108580586, -0.0012724031135282789, -0.0006326119956056747],
                    [-0.008777986288223578, 0.013041426332937813, -0.0029865756606928667, 0.006331900557094506, 9.559035497315502e-06, 0.0024406834587570444, 0.0014287594355276935],
                    [0.0009721238940983024, -0.0029865756606928667, 0.0034152598915310737, -0.002581106921966777, 0.0004522639757064418, -0.000852076337650784, -0.0005857498290054954],
                    [-0.0031221902953149925, 0.006331900557094506, -0.002581106921966777, 0.009810980383044477, 0.0008736151709440963, 0.0010860803978182847, 0.0006697391255171004],
                    [-0.00028407712108580586, 9.559035497315502e-06, 0.0004522639757064418, 0.0008736151709440963, 0.0006001212516048076, -0.00010125739990906646, -8.303407301620206e-05],
                    [-0.0012724031135282789, 0.0024406834587570444, -0.000852076337650784, 0.0010860803978182847, -0.00010125739990906646, 0.007407002973675, 0.003900955856224677],
                    [-0.0006326119956056747, 0.0014287594355276935, -0.0005857498290054954, 0.0006697391255171004, -8.303407301620206e-05, 0.003900955856224677, 0.0022591791781077122]
                ], [
                    [0.005535015521031184, -0.00821906793857138, -0.00020570427832911688, -0.002668752048211221, -6.864778906597793e-05, -0.0014307392572495941, -0.001077024542994729],
                    [-0.00821906793857138, 0.018179761764009334, 0.0022778230282678035, 0.004315155577228411, 0.0007631060207498307, -0.00021975210207021416, 0.0005096433146465212],
                    [-0.00020570427832911688, 0.0022778230282678035, 0.005271896590861272, 0.0006736682269920776, 0.0027806802682252174, -0.002565395181735502, -0.001329325177933554],
                    [-0.002668752048211221, 0.004315155577228411, 0.0006736682269920776, 0.011555565293658254, 0.0038222591339815847, 0.0027493022344800863, 0.0015450451479367493],
                    [-6.864778906597793e-05, 0.0007631060207498307, 0.0027806802682252174, 0.0038222591339815847, 0.0032841073930092598, -0.0008820550248675384, -0.00044690343108490146],
                    [-0.0014307392572495941, -0.00021975210207021416, -0.002565395181735502, 0.0027493022344800863, -0.0008820550248675384, 0.01479812250533739, 0.00672475164135033],
                    [-0.001077024542994729, 0.0005096433146465212, -0.001329325177933554, 0.0015450451479367493, -0.00044690343108490146, 0.00672475164135033, 0.0035160180042092936]
                ]
            ]

            reduced_model_covar_matrices = [
                [
                    [0.022648650334570496, -0.027645127220884753, 0.002743395757837704, -0.00019517536806345955],
                    [-0.027645127220884753, 0.04084579216897273, -0.004654797440117838, -0.0014262888836593],
                    [0.002743395757837704, -0.004654797440117838, 0.04777305454209432, 0.02683372194610089],
                    [-0.00019517536806345955, -0.0014262888836593, 0.02683372194610089, 0.018412469396056032]
                ], [
                    [0.010306188761245687, -0.008651122978231673, 0.00017446462922569904, -0.00045543844108437124],
                    [-0.008651122978231673, 0.011728705974255975, -0.000651922187728199, 7.0917358039492e-05],
                    [0.00017446462922569904, -0.000651922187728199, 0.005210963912387357, 0.002931902523192387],
                    [-0.00045543844108437124, 7.0917358039492e-05, 0.002931902523192387, 0.002116691221292608]
                ], [
                    [0.01678520002721852, -0.013126903237079976, -0.0008529987669254292, -0.0003002618319876916],
                    [-0.013126903237079976, 0.022305926985780374, 0.0004166108774680984, -0.0006483711749512275],
                    [-0.0008529987669254292, 0.0004166108774680984, 0.003748167800896899, 0.0023465972932717213],
                    [-0.0003002618319876916, -0.0006483711749512275, 0.0023465972932717213, 0.001968965997741974]
                ], [
                    [0.016107288005557895, -0.016942901504210104, -0.0002097482502627844, -0.00010264358905760681],
                    [-0.016942901504210104, 0.045979483249919066, 0.002052812069807938, 0.001091693401271756],
                    [-0.0002097482502627844, 0.002052812069807938, 0.016845560433143125, 0.010225807306905454],
                    [-0.00010264358905760681, 0.001091693401271756, 0.010225807306905454, 0.007077800371372914]
                ], [
                    [0.003422635196015581, -0.0032209052856532767, -1.39815301941015e-05, -9.99260970413752e-06],
                    [-0.0032209052856532767, 0.006839391401543439, 2.3311159776708222e-05, -5.616191239811191e-05],
                    [-1.39815301941015e-05, 2.3311159776708222e-05, 0.0018716601385022444, 0.001022135426731448],
                    [-9.99260970413752e-06, -5.616191239811191e-05, 0.001022135426731448, 0.0007150990959241952]
                ], [
                    [0.01145965687215369, -0.008777986288223578, -0.0012724031135282789, -0.0006326119956056747],
                    [-0.008777986288223578, 0.013041426332937813, 0.0024406834587570444, 0.0014287594355276935],
                    [-0.0012724031135282789, 0.0024406834587570444, 0.007407002973675, 0.003900955856224677],
                    [-0.0006326119956056747, 0.0014287594355276935, 0.003900955856224677, 0.0022591791781077122]
                ], [
                    [0.005535015521031184, -0.00821906793857138, -0.0014307392572495941, -0.001077024542994729],
                    [-0.00821906793857138, 0.018179761764009334, -0.00021975210207021416, 0.0005096433146465212],
                    [-0.0014307392572495941, -0.00021975210207021416, 0.01479812250533739, 0.00672475164135033],
                    [-0.001077024542994729, 0.0005096433146465212, 0.00672475164135033, 0.0035160180042092936]
                ]
            ]

            covar_determinants = [2.503818305363261e-16, 1.2190023036202048e-19, 3.1646102970796588e-18, 1.6173029168915614e-15, 7.164199940608137e-23, 5.175307773962127e-19, 4.556970266962947e-18]
            reduced_model_covar_determinants = [2.3422368956389924e-08, 1.0366483271019205e-10, 3.385159012314613e-10, 6.5971093123341194e-09, 3.795131740193036e-12, 1.0013498514757284e-10, 1.903136540430233e-10]

            inverse_covar_matrices = [
                [
                    [2068.873414732544, 1255.4300935364158, -1963.9242700193674, -899.2861848713734, 2943.8121086297842, -18.11842323622629, -46.75282329544081],
                    [1255.4300935364176, 840.5309754070763, -1159.5277448028896, -582.7343734576117, 1880.8482134394608, -1.209856029795844, -45.93426239559742],
                    [-1963.924270019372, -1159.5277448028921, 2260.69439735951, 1164.9790688427831, -3439.8774308672787, -11.217796443903971, 102.21993518921408],
                    [-899.2861848713763, -582.7343734576134, 1164.9790688427847, 829.8183055199519, -2024.9846876700792, 5.899206356939, 23.723429823435815],
                    [2943.8121086297892, 1880.8482134394633, -3439.8774308672796, -2024.9846876700776, 5691.938505647845, 20.87227661891154, -169.97575499606316],
                    [-18.1184232362252, -1.209856029795154, -11.217796443905163, 5.899206356938324, 20.872276618913467, 125.94076035850581, -188.58887613091227],
                    [-46.75282329544326, -45.934262395598914, 102.21993518921673, 23.72342982343725, -169.9757549960673, -188.5888761309122, 344.29175117111095]
                ], [
                    [1496.8171342767978, 662.6976842414196, -1304.8623387407577, -511.97216740109087, 1525.881512788564, -19.01932632710178, 40.62058341138062],
                    [662.6976842414196, 1019.7038491301781, -587.1825030690075, -910.7410766408553, 1286.4838542022464, -12.030451623515988, 4.879721852201644],
                    [-1304.8623387407574, -587.1825030690073, 1402.508247992705, 644.852784250863, -1809.592646515749, -40.05350295709109, 98.95634679997286],
                    [-511.972167401091, -910.7410766408553, 644.852784250863, 1046.6957342490746, -1463.8829970014046, 31.86415218804891, 7.5229977848749],
                    [1525.8815127885646, 1286.4838542022471, -1809.5926465157497, -1463.882997001405, 3675.2648696047104, 25.163252753528077, -123.65910286095338],
                    [-19.01932632710198, -12.030451623516068, -40.053502957090885, 31.864152188048973, 25.163252753527868, 926.244183147684, -1295.7181249972296],
                    [40.62058341138096, 4.879721852201727, 98.9563467999725, 7.522997784874812, -123.65910286095303, -1295.7181249972296, 2297.2861508510027]
                ], [
                    [3566.641419221215, 2357.4022555068473, -3535.6634461645704, -2340.1230192766398, 4165.094929195927, 281.8913124117738, -177.04303324748068],
                    [2357.402255506847, 1616.3522716738344, -2358.6531869061255, -1598.5760918005492, 2805.7690731949374, 166.17966290897363, -112.90274885772979],
                    [-3535.66344616457, -2358.653186906125, 3650.5858393100366, 2482.601467857534, -4371.609089839267, -371.82369447210294, 377.16727950404197],
                    [-2340.1230192766393, -1598.5760918005485, 2482.601467857534, 1839.2189976468005, -3104.91136013646, -389.17930893138293, 553.5488084958024],
                    [4165.094929195926, 2805.769073194937, -4371.609089839267, -3104.91136013646, 5544.619276600624, 445.5397307719116, -527.9990393821301],
                    [281.8913124117735, 166.17966290897334, -371.8236944721026, -389.1793089313827, 445.5397307719112, 1367.4477212970132, -1799.946916540506],
                    [-177.04303324748042, -112.90274885772943, 377.16727950404146, 553.5488084958021, -527.9990393821295, -1799.946916540506, 3005.6568743346756]
                ], [
                    [138.45733040977768, 52.49166197030999, 10.698163635838378, 67.69308889038926, -73.80075193749911, -6.281354007821093, 8.968326480895424],
                    [52.49166197030998, 42.98767388558653, 0.3053692020997214, 24.29285505069042, -6.713500087313867, -11.528166018011973, 11.81780289134441],
                    [10.698163635838396, 0.30536920209973306, 183.38976240886416, 123.76636952818404, -334.2315210127521, -1.9894882285774025, 25.863597459344152],
                    [67.69308889038932, 24.29285505069043, 123.76636952818403, 184.88694175125684, -327.0919671182833, 0.5923982933616394, 20.19195940251452],
                    [-73.80075193749921, -6.713500087313899, -334.23152101275207, -327.0919671182833, 930.2791268983273, -57.947644470572264, 21.438319410861116],
                    [-6.2813540078210846, -11.528166018011976, -1.9894882285773763, 0.592398293361688, -57.947644470572364, 500.44685258771375, -718.1278774079128],
                    [8.968326480895406, 11.817802891344401, 25.86359745934414, 20.19195940251447, 21.43831941086117, -718.1278774079127, 1176.6256220992946]
                ], [
                    [1006.3552927975084, 550.0220574202741, -15.72087215560552, 536.5682352053572, -468.2750592461094, 42.14090059092678, -77.11349505583065],
                    [550.0220574202741, 454.9955525534457, -30.824869390689138, 320.25920808365305, -560.1761591509465, 1.291707779493946, -6.5477554527813995],
                    [-15.720872155605797, -30.82486939068927, 910.0775478277359, 677.9668345841226, -2132.7018191842462, -87.8679749849518, 180.21629321067905],
                    [536.5682352053568, 320.2592080836529, 677.9668345841227, 1132.3880512111089, -2099.60632794375, 53.35999249053167, -84.57690206876228],
                    [-468.27505924610864, -560.1761591509462, -2132.7018191842462, -2099.6063279437494, 98199.81143258142, 31.99901751347683, -47.82061078308919],
                    [42.140900590926776, 1.2917077794939382, -87.86797498495179, 53.35999249053168, 31.999017513476876, 2483.107436202298, -3570.029358229674],
                    [-77.11349505583064, -6.547755452781389, 180.21629321067903, -84.5769020687623, -47.820610783089265, -3570.0293582296736, 6540.427969415803]
                ], [
                    [205.00181150917652, 170.23139933702384, 32.88630585463846, -45.647878927460724, 129.88239717240631, 40.94392154830521, -94.1198301354415],
                    [170.23139933702384, 268.1913043512978, 63.528268256564346, -114.05151032615287, 184.2481423635153, 17.606962283845238, -95.29085223630386],
                    [32.88630585463848, 63.528268256564374, 567.1691665163905, 173.86231833670107, -655.8890732329265, -63.947441313901365, 150.8554575620803],
                    [-45.64787892746072, -114.0515103261529, 173.86231833670112, 251.9854685168603, -516.2100745942382, 0.807177965354444, 9.35661996544876],
                    [129.88239717240623, 184.24814236351529, -655.8890732329265, -516.2100745942381, 2975.337024744881, -43.03197930441705, 86.48196980758944],
                    [40.94392154830527, 17.606962283845288, -63.947441313901344, 0.807177965354449, -43.0319793044171, 1519.5820887672091, -2641.9542662200624],
                    [-94.11983013544159, -95.29085223630389, 150.8554575620802, 9.356619965448743, 86.48196980758954, -2641.9542662200624, 5077.964361009916]
                ], [
                    [652.5708257637217, 286.4002385144235, -47.48455983066927, 49.228810423961, -55.04627981628542, -31.47391882814259, 171.9967270203159],
                    [286.4002385144234, 211.23320388739023, -142.27157909168542, -62.89344309003439, 157.7662029073319, 31.102884999728367, -8.475043878928098],
                    [-47.484559830669234, -142.27157909168545, 681.7361833530691, 288.6259242505225, -878.0137380270198, -45.977384612023165, 113.33100464746762],
                    [49.22881042396102, -62.89344309003439, 288.6259242505224, 316.5612041253031, -608.7083949126653, -26.32309447729782, -32.81194287975318],
                    [-55.04627981628565, 157.76620290733186, -878.0137380270197, -608.7083949126655, 1734.9285691365778, 64.59963093205316, -7.237006548432747],
                    [-31.473918828142626, 31.10288499972835, -45.97738461202301, -26.323094477297783, 64.59963093205297, 543.423684990417, -1051.1088403077301],
                    [171.99672702031597, -8.475043878928075, 113.33100464746737, -32.81194287975321, -7.237006548432504, -1051.1088403077301, 2405.02900802712]
                ]
            ]

            inverse_reduced_model_covar_matrices = [
                [
                    [272.30326267780845, 182.31115584843502, -40.9422755242826, 76.6767819873952],
                    [182.311155848435, 147.0791413150951, -19.97438171879356, 42.4357526142268],
                    [-40.9422755242826, -19.974381718793556, 123.75374091281181, -182.33587051944366],
                    [76.67678198739519, 42.435752614226786, -182.33587051944366, 324.14126445022674]
                ], [
                    [263.832660714436, 190.4267075617705, -60.54314154986999, 134.24800146381887],
                    [190.4267075617705, 226.4365429167191, 14.357705669519833, 13.499355824013046],
                    [-60.543141549869986, 14.357705669519829, 921.4202872625397, -1289.7990610259646],
                    [134.24800146381884, 13.499355824013021, -1289.7990610259646, 2287.4141653649262]
                ], [
                    [114.04170782243978, 69.77197663846222, -27.8656714134046, 73.5766995801617],
                    [69.77197663846223, 91.21723423340136, -77.70809951925145, 133.28930167443954],
                    [-27.865671413404595, -77.70809951925146, 1133.587886910842, -1380.8389578922347],
                    [73.5766995801617, 133.28930167443957, -1380.8389578922347, 2208.6649448309]
                ], [
                    [101.57463256998027, 37.589836885544, -5.616161059644245, 3.789198247283468],
                    [37.589836885544, 35.79182842842991, -7.1014395710954314, 5.28449568345971],
                    [-5.616161059644234, -7.101439571095422, 484.1820572478423, -698.5187526738745],
                    [3.789198247283438, 5.284495683459693, -698.5187526738745, 1149.7269809780723]
                ], [
                    [526.858771197597, 249.29546576348747, -63.27054042503345, 117.37766904547071],
                    [249.2954657634875, 264.8275926615559, -66.98465115590159, 120.02773018865659],
                    [-63.270540425033474, -66.9846511559016, 2452.0554060986274, -3511.0195735366997],
                    [117.37766904547071, 120.02773018865659, -3511.0195735366997, 6427.992165507683]
                ], [
                    [183.78116354684408, 126.96929719911408, 54.29495192009049, -122.58816215610592],
                    [126.9692971991141, 170.11354555015822, 40.74874088620492, -142.39157094982863],
                    [54.2949519200905, 40.74874088620499, 1506.1061646832477, -2611.181189399888],
                    [-122.58816215610602, -142.39157094982883, -2611.181189399888, 5007.126137096883]
                ], [
                    [621.3501554982278, 274.55496468521744, -32.52919555872185, 212.7506245247155],
                    [274.5549646852175, 178.89092239544047, 21.142882920338284, 17.733480323814206],
                    [-32.52919555872191, 21.142882920338185, 540.0528321624116, -1045.9364076096142],
                    [212.75062452471542, 17.733480323814312, -1045.9364076096144, 2347.4744607103094]
                ]
            ]

    return params, covar_matrices, reduced_model_covar_matrices, covar_determinants, reduced_model_covar_determinants,\
        inverse_covar_matrices, inverse_reduced_model_covar_matrices



